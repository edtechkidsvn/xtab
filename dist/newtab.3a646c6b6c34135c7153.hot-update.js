webpackHotUpdate("newtab",{

/***/ "./src/tags/novels.tag":
/*!*****************************!*\
  !*** ./src/tags/novels.tag ***!
  \*****************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash */ \"./node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"./node_modules/axios/index.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jssoup__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jssoup */ \"./node_modules/jssoup/dist/lib/jssoup.js\");\n/* harmony import */ var jssoup__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jssoup__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pouchdb__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pouchdb */ \"./node_modules/pouchdb/lib/index-browser.es.js\");\n\n    var riot = __webpack_require__(/*! riot */ \"./node_modules/riot/riot.js\")\n    \n\n\n\nriot.tag2('novels', '<h2>Novels</h2> <div id=\"search_panel\"> <input class=\"fullwidth\" id=\"input_search\" ref=\"searchInput\" autocomplete=\"off\"> <div id=\"search_result_container\"> <h3 if=\"{loading}\">Loading ...</h3> <div if=\"{!loading}\"> <h3 if=\"{searchResults.length != 0}\">Search results</h3> <div class=\"search-result-iem\" each=\"{searchResults}\"> <span>{title}</span> <span if=\"{novelStates[link] == \\'adding\\'}\" class=\"add-novel-loading\">...</span> <span if=\"{novelStates[link] != \\'adding\\'}\" class=\"add-novel-btn\" link=\"{link}\"> <svg if=\"{novelStates[link] != \\'added\\'}\" xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewbox=\"0 0 24 24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"></path></svg> <svg if=\"{novelStates[link] == \\'added\\'}\" xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewbox=\"0 0 24 24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"></path><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\"></path></svg> </span> </div> </div> </div> </div>', 'novels .search-result-iem,[data-is=\"novels\"] .search-result-iem{ margin: 0; margin-bottom: 16px; display: flex; } novels .add-novel-btn,[data-is=\"novels\"] .add-novel-btn{ cursor: pointer; margin-left: 8px; display: flex; align-items: center; } novels .add-novel-loading,[data-is=\"novels\"] .add-novel-loading{ margin-left: 8px; }', '', function(opts) {\nlet db = new pouchdb__WEBPACK_IMPORTED_MODULE_3__[\"default\"]('novels-db');\nconst riotTag = this;\n\nif (!riotTag.novelStates) {\n  riotTag.novelStates = {};\n}\n\nasync function doSearch(searchString) {\n  riotTag.loading = true;\n  riotTag.update();\n  const searchUrl = `https://cors-anywhere.herokuapp.com/https://webtruyen.com/home/search?key=${searchString}`;\n  const config = {\n    headers: {\n      'Access-Control-Allow-Origin': '*'\n    }\n  };\n  const searchResponse = await axios__WEBPACK_IMPORTED_MODULE_1___default.a.get(searchUrl, config);\n  const soup = new jssoup__WEBPACK_IMPORTED_MODULE_2___default.a(searchResponse.data);\n  const searchRows = soup.findAll('div', 'search-row');\n  const searchResults = searchRows.map(row => {\n    const a = row.find('a');\n    return {\n      title: a.attrs.title,\n      link: a.attrs.href\n    };\n  }).filter(result => result.link && !result.link.includes('https://webtruyen.com/searching/'));\n  riotTag.loading = false;\n  riotTag.searchResults = searchResults;\n  riotTag.update();\n}\n\nasync function doAdd(novelLink) {\n  riotTag.novelStates[link] = 'adding';\n  riotTag.update(); // Get page number\n  // Get chapter\n  // Get data from a chapter\n\n  riotTag.novelStates[link] = 'added';\n  riotTag.update();\n}\n\nthis.on('mount', () => {\n  const searchInput = this.refs.searchInput;\n  searchInput.addEventListener('click', e => {\n    e.preventDefault();\n    e.target.select();\n  });\n\n  const handleSearchEvent = lodash__WEBPACK_IMPORTED_MODULE_0___default.a.debounce(async e => {\n    const searchString = e.target.value;\n    const asciiCode = e.which;\n\n    if (asciiCode === 8 || asciiCode >= 65 && asciiCode <= 98 || asciiCode >= 48 && asciiCode <= 57) {\n      await doSearch(searchString);\n    }\n  }, 300);\n\n  searchInput.addEventListener('keyup', handleSearchEvent);\n});\nthis.on('update', async () => {\n  const buttons = await this.root.getElementsByClassName('add-novel-btn');\n  Array.from(buttons).forEach(btn => {\n    const link = btn.getAttribute('link');\n    btn.addEventListener('click', async e => {\n      await doAdd(link);\n    });\n  });\n});\n});\n    \n  if (true) {\n    module.hot.accept()\n    if (module.hot.data) {\n      riot.reload('novels')\n    }\n  }\n  //# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdGFncy9ub3ZlbHMudGFnLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL3RhZ3Mvbm92ZWxzLnRhZz82MTE2Il0sInNvdXJjZXNDb250ZW50IjpbIjxub3ZlbHM+XG4gIDxoMj5Ob3ZlbHM8L2gyPlxuICA8ZGl2IGlkPVwic2VhcmNoX3BhbmVsXCI+XG4gICAgPGlucHV0IGNsYXNzPVwiZnVsbHdpZHRoXCIgaWQ9XCJpbnB1dF9zZWFyY2hcIiByZWY9XCJzZWFyY2hJbnB1dFwiIGF1dG9jb21wbGV0ZT1cIm9mZlwiIC8+XG4gICAgPGRpdiBpZD1cInNlYXJjaF9yZXN1bHRfY29udGFpbmVyXCI+XG4gICAgICA8aDMgaWY9e2xvYWRpbmd9PkxvYWRpbmcgLi4uPC9oMz5cbiAgICAgIDxkaXYgaWY9eyFsb2FkaW5nfT5cbiAgICAgICAgPGgzIGlmPXtzZWFyY2hSZXN1bHRzLmxlbmd0aCAhPSAwfT5TZWFyY2ggcmVzdWx0czwvaDM+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJzZWFyY2gtcmVzdWx0LWllbVwiIGVhY2g9e3NlYXJjaFJlc3VsdHN9PlxuICAgICAgICAgIDxzcGFuPnt0aXRsZX08L3NwYW4+XG4gICAgICAgICAgPHNwYW4gaWY9e25vdmVsU3RhdGVzW2xpbmtdID09ICdhZGRpbmcnfSBjbGFzcz1cImFkZC1ub3ZlbC1sb2FkaW5nXCI+Li4uPC9zcGFuPlxuICAgICAgICAgIDxzcGFuIGlmPXtub3ZlbFN0YXRlc1tsaW5rXSAhPSAnYWRkaW5nJ30gY2xhc3M9XCJhZGQtbm92ZWwtYnRuXCIgbGluaz17bGlua30+XG4gICAgICAgICAgICA8c3ZnIGlmPXtub3ZlbFN0YXRlc1tsaW5rXSAhPSAnYWRkZWQnfSB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxMlwiIGhlaWdodD1cIjEyXCIgdmlld0JveD1cIjAgMCAyNCAyNFwiPjxwYXRoIGQ9XCJNMCAwaDI0djI0SDB6XCIgZmlsbD1cIm5vbmVcIi8+PHBhdGggZD1cIk0xMyA3aC0ydjRIN3YyaDR2NGgydi00aDR2LTJoLTRWN3ptLTEtNUM2LjQ4IDIgMiA2LjQ4IDIgMTJzNC40OCAxMCAxMCAxMCAxMC00LjQ4IDEwLTEwUzE3LjUyIDIgMTIgMnptMCAxOGMtNC40MSAwLTgtMy41OS04LThzMy41OS04IDgtOCA4IDMuNTkgOCA4LTMuNTkgOC04IDh6XCIvPjwvc3ZnPlxuICAgICAgICAgICAgPHN2ZyBpZj17bm92ZWxTdGF0ZXNbbGlua10gPT0gJ2FkZGVkJ30geG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTJcIiBoZWlnaHQ9XCIxMlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIj48cGF0aCBkPVwiTTAgMGgyNHYyNEgwelwiIGZpbGw9XCJub25lXCIvPjxwYXRoIGQ9XCJNMTIgMkM2LjQ4IDIgMiA2LjQ4IDIgMTJzNC40OCAxMCAxMCAxMCAxMC00LjQ4IDEwLTEwUzE3LjUyIDIgMTIgMnptLTIgMTVsLTUtNSAxLjQxLTEuNDFMMTAgMTQuMTdsNy41OS03LjU5TDE5IDhsLTkgOXpcIi8+PC9zdmc+XG4gICAgICAgICAgPC9zcGFuPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cblxuICA8c3R5bGU+XG4gICAgLnNlYXJjaC1yZXN1bHQtaWVtIHtcbiAgICAgIG1hcmdpbjogMDtcbiAgICAgIG1hcmdpbi1ib3R0b206IDE2cHg7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgIH1cblxuICAgIC5hZGQtbm92ZWwtYnRuIHtcbiAgICAgIGN1cnNvcjogcG9pbnRlcjtcbiAgICAgIG1hcmdpbi1sZWZ0OiA4cHg7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICB9XG5cbiAgICAuYWRkLW5vdmVsLWxvYWRpbmcge1xuICAgICAgbWFyZ2luLWxlZnQ6IDhweDtcbiAgICB9XG5cbiAgPC9zdHlsZT5cbiAgPHNjcmlwdD5cbiAgICBpbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuICAgIGltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG4gICAgaW1wb3J0IEpTU291cCBmcm9tICdqc3NvdXAnO1xuICAgIGltcG9ydCBQb3VjaERCIGZyb20gJ3BvdWNoZGInO1xuXG4gICAgbGV0IGRiID0gbmV3IFBvdWNoREIoJ25vdmVscy1kYicpO1xuXG4gICAgY29uc3QgcmlvdFRhZyA9IHRoaXM7XG4gICAgaWYgKCFyaW90VGFnLm5vdmVsU3RhdGVzKSB7XG4gICAgICByaW90VGFnLm5vdmVsU3RhdGVzID0ge307XG4gICAgfVxuICAgIGFzeW5jIGZ1bmN0aW9uIGRvU2VhcmNoKHNlYXJjaFN0cmluZykge1xuICAgICAgcmlvdFRhZy5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgIHJpb3RUYWcudXBkYXRlKCk7XG5cbiAgICAgIGNvbnN0IHNlYXJjaFVybCA9IGBodHRwczovL2NvcnMtYW55d2hlcmUuaGVyb2t1YXBwLmNvbS9odHRwczovL3dlYnRydXllbi5jb20vaG9tZS9zZWFyY2g/a2V5PSR7c2VhcmNoU3RyaW5nfWA7XG4gICAgICBjb25zdCBjb25maWcgPSB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJzogJyonXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBjb25zdCBzZWFyY2hSZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldChzZWFyY2hVcmwsIGNvbmZpZyk7XG4gICAgICBjb25zdCBzb3VwID0gbmV3IEpTU291cChzZWFyY2hSZXNwb25zZS5kYXRhKTtcbiAgICAgIGNvbnN0IHNlYXJjaFJvd3MgPSBzb3VwLmZpbmRBbGwoJ2RpdicsICdzZWFyY2gtcm93Jyk7XG4gICAgICBjb25zdCBzZWFyY2hSZXN1bHRzID0gc2VhcmNoUm93cy5tYXAocm93ID0+IHtcbiAgICAgICAgY29uc3QgYSA9IHJvdy5maW5kKCdhJyk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdGl0bGU6IGEuYXR0cnMudGl0bGUsXG4gICAgICAgICAgbGluazogYS5hdHRycy5ocmVmLFxuICAgICAgICB9O1xuICAgICAgfSlcbiAgICAgIC5maWx0ZXIocmVzdWx0ID0+IHJlc3VsdC5saW5rICYmICFyZXN1bHQubGluay5pbmNsdWRlcygnaHR0cHM6Ly93ZWJ0cnV5ZW4uY29tL3NlYXJjaGluZy8nKSk7XG4gICAgICByaW90VGFnLmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHJpb3RUYWcuc2VhcmNoUmVzdWx0cyA9IHNlYXJjaFJlc3VsdHM7XG4gICAgICByaW90VGFnLnVwZGF0ZSgpO1xuICAgIH1cblxuICAgIGFzeW5jIGZ1bmN0aW9uIGRvQWRkKG5vdmVsTGluaykge1xuICAgICAgcmlvdFRhZy5ub3ZlbFN0YXRlc1tsaW5rXSA9ICdhZGRpbmcnO1xuICAgICAgcmlvdFRhZy51cGRhdGUoKTtcbiAgICAgIC8vIEdldCBwYWdlIG51bWJlclxuICAgICAgLy8gR2V0IGNoYXB0ZXJcbiAgICAgIC8vIEdldCBkYXRhIGZyb20gYSBjaGFwdGVyXG4gICAgICByaW90VGFnLm5vdmVsU3RhdGVzW2xpbmtdID0gJ2FkZGVkJztcbiAgICAgIHJpb3RUYWcudXBkYXRlKCk7XG4gICAgfVxuXG4gICAgdGhpcy5vbignbW91bnQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzZWFyY2hJbnB1dCA9IHRoaXMucmVmcy5zZWFyY2hJbnB1dDtcbiAgICAgIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnRhcmdldC5zZWxlY3QoKTtcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaGFuZGxlU2VhcmNoRXZlbnQgPSBfLmRlYm91bmNlKGFzeW5jIChlKSA9PiB7XG4gICAgICAgIGNvbnN0IHNlYXJjaFN0cmluZyA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICBjb25zdCBhc2NpaUNvZGUgPSBlLndoaWNoO1xuICAgICAgICBpZiAoKChhc2NpaUNvZGUgPT09OCkgfHwgKGFzY2lpQ29kZSA+PSA2NSAmJiBhc2NpaUNvZGUgPD0gOTgpIHx8ICggYXNjaWlDb2RlID49NDggJiYgYXNjaWlDb2RlIDw9IDU3KSkpIHtcbiAgICAgICAgICBhd2FpdCBkb1NlYXJjaChzZWFyY2hTdHJpbmcpO1xuICAgICAgICB9XG4gICAgICB9LCAzMDApO1xuICAgICAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBoYW5kbGVTZWFyY2hFdmVudCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLm9uKCd1cGRhdGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBidXR0b25zID0gYXdhaXQgdGhpcy5yb290LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2FkZC1ub3ZlbC1idG4nKTtcbiAgICAgIEFycmF5LmZyb20oYnV0dG9ucykuZm9yRWFjaChidG4gPT4ge1xuICAgICAgICBjb25zdCBsaW5rID0gYnRuLmdldEF0dHJpYnV0ZSgnbGluaycpO1xuICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xuICAgICAgICAgIGF3YWl0IGRvQWRkKGxpbmspO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICA8L3NjcmlwdD5cbjwvbm92ZWxzPiJdLCJtYXBwaW5ncyI6IkFBeUJBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQWdCQTtBQUNBO0FBQ0E7QUEvQkE7QUFpQ0E7QUFFQTtBQUNBO0FBaERBO0FBQ0E7QUFrREE7QUE5Q0E7QUFnREE7QUFFQTtBQW5DQTtBQVFBO0FBOEJBOztBQUVBO0FBQ0E7QUFDQTtBQTVEQTtBQUVBO0FBNkRBO0FBQ0E7QUF6REE7QUEyREE7O0FBR0E7QUFDQTtBQWpFQTs7O0FBMkJBO0FBeEJBO0FBSUE7QUF5QkE7QUEyQ0E7QUFDQTs7O0FBSUE7QUFwRkE7QUFzRkE7QUFDQTtBQXBFQTtBQWdEQTtBQXVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBR0E7QUEvRUE7QUFpRkE7QUFDQTtBQTNFQTtBQTZFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/tags/novels.tag\n");

/***/ })

})